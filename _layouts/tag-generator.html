---
layout: post
---

{% capture generateHTML %}
{% case forTag %}
  {% when filterTags or site.data.tags %}
    {% for tag in filterTags %}
      {% if tag.name %}
        <div class="filter value chip" data-value="{{ tag.name }}">
          {{ tag.name }}
        </div>
      {% elsif tag.hasValue %}
        <div class="filter value chip" data-value="{{ tag.group }}">
          {{ tag.group }}
        </div>
        {% assign branch = tag.group | replace: "/", "or" | split: " " | join: "-" %}
        <div id="{{ branch | append: "-chip-box" }}">
          {{ generateHTML }}
        </div>
      {% else %}
        <div class="filter chip">
          {{ tag.group }}
        </div>
        {% assign branch = tag.group | replace: "/", "or" | split: " " | join: "-" %}
        <div id="{{ branch | append: "-chip-box" }}">
          {{ generateHTML }}
        </div>
      {% endif %}
    {% endfor %}
  {% when choiceTags %}
    {% for tag in choiceTags %}
      {% if tag.name %}
        <div class="choice value chip" data-group="{{ branch }}" data-value="{{ tag.name }}">
          {{ tag.name }}
        </div>
      {% elsif tag.hasValue %}
        <div class="choice value chip" data-group="{{ branch }}" data-value="{{ tag.group }}">
          {{ tag.group }}
        </div>
        {% assign branch = tag.group | replace: "/", "or" | split: " " | join: "-" %}
        <div id="{{ branch | append: "-chip-box" }}">
          {{ generateHTML }}
        </div>
      {% else %}
        <div class="choice chip" data-group="{{ branch }}">
          {{ tag.group }}
        </div>
        {% assign branch = tag.group | replace: "/", "or" | split: " " | join: "-" %}
        <div id="{{ branch | append: "-chip-box" }}">
          {{ generateHTML }}
        </div>
      {% endif %}
    {% endfor %}
  {% else %}
    vvvv
{% endcase %}
{% endcapture %}

<h3>Tags</h3>
<div id="root-chip-box">
  {% assign forTag = site.data.tags %}
  {{ generateHTML }}
</div>

<h3>choChip</h3>
<div class="choice chip" data-group="fruit1" data-value="apple">Apple</div>
<div class="choice chip" data-group="fruit1" data-value="banana">Banana</div>
<div class="choice chip" data-group="fruit1" data-value="orange">Orange</div>

<h3>Prompt</h3>
<div id="promptContainer"></div>

<button onclick="downloadPrompt();">Download Prompt</button>


<script>

const chips = document.querySelectorAll(".chip");

let prompt = [];

chips.forEach(chip => {
  const detail = chip.nextElementSibling;
  if (chip.classList.contains("choice")) {
    chip.addEventListener("click", () => {
      if (chip.classList.contains("selected")) {
        chip.classList.remove("selected");
        detail.classList.remove("active");
        updatePrompt();
      } else {
        const group = document.querySelectorAll(`[data-group="${chip.dataset.group}"]`);
        group.forEach(chip => {
          chip.classList.remove("selected");
        });
        chip.classList.add("selected");
        detail.classList.add("active");
        updatePrompt();
      }
    });
  } else {
    chip.addEventListener("click", () => {
      chip.classList.toggle("selected");
      detail.classList.toggle("active");
      updatePrompt();
    });
  }
});

function updatePrompt() {
  const selectedChips = document.querySelectorAll(".chip.selected");
  prompt = Array.from(selectedChips).map(chip => chip.dataset.value).join(", ");
  const promptContainer = document.getElementById("promptContainer");
  promptContainer.textContent = prompt;
}

function downloadPrompt() {
  const blob = new Blob([prompt], {type: "text/plain;charset=utf-8"});
  const filename = "tags.txt";
  if (window.navigator.msSaveOrOpenBlob) {
    window.navigator.msSaveBlob(blob, filename);
  } else {
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = filename;
    link.click();
    URL.revokeObjectURL(link.href);
  }
}

</script>